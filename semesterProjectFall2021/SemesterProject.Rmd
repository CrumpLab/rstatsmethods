---
title             : "My new demo of a semester long project"
shorttitle        : "Semester project"

author: 
  - name          : "Matthew Crump"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "2900 Bedford Avenue"
    email         : "mcrump@brooklyn.cuny.edu"
      
affiliation:
  - id            : "1"
    institution   : "Brooklyn College"

authornote: |
  Matthew J. C. Crump, Department of Psychology, Brooklyn College of the City University of New York, and Graduate Center of the City University of New York.

abstract: |
  This is a demo for the semester long project in PSYC 7765/66.
  
keywords          : "Stroop, Posture, Reproducible analysis"
wordcount         : "1000"

bibliography      : ["r-references.bib","myReferences.bib"]

floatsintext      : no
figurelist        : yes
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
library("papaja")
r_refs("r-references.bib")
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```


This is a short example of creating an APA manuscript using papaja. It is intended to provide example code for your semester project. This would normally be the introduction to your paper. Below is a very brief introduction.

This report reproduces the analysis of Experiment 3 reported in @rosenbaum2017stand. The data were downloaded from [https://osf.io/b7x8q/](https://osf.io/b7x8q/)

@rosenbaum2017stand had participants perform a Stroop task [for a review see, @macleod1991half;@bugg2012support] in one of two posture conditions. Participants either sat and performed the Stroop task, or stood and performed the Stroop task. The question was whether the size of the Stroop effect would change as a function of posture. The Stroop effect is measured as a difference between reaction times on congruent vs. incongruent trials.The experiment involved a 2 (Posture: sitting vs standing) x 2 (congruency: congruent vs. incongruent) repeated measures design. 

# Methods

## Participants

There were 50 participants

## Material

The details of the Stroop experiment are report in the paper [@rosenbaum2017stand].

## Procedure

In each posture condition, participants completed 72 Stroop trials, half congruent and half incongruent.

# Results

First, the means for each condition collapsed across subjects are presented in Table 1.

```{r}
# load the data by script
library(readr)
all_data <- read_csv("StroopData.csv")

# Reshape Data
RTs <- c(as.numeric(unlist(all_data[,1])),
         as.numeric(unlist(all_data[,2])),
         as.numeric(unlist(all_data[,3])),
         as.numeric(unlist(all_data[,4]))
         )

Congruency <- rep(rep(c("Congruent","Incongruent"),each=50),2)
Posture <- rep(c("Stand","Sit"),each=100)
Subject <- rep(1:50,4)

stroop_df <- data.frame(Subject,Congruency,Posture,RTs)

# make table of means

library(dplyr)

table_means <- stroop_df %>%
            group_by(Congruency,Posture) %>%
            summarise(mean_RT = mean(RTs),
                      SEM = sd(RTs)/sqrt(length(RTs)))

apa_table(table_means)

```

Additionally, the means for each condition are plotted in Figure 1.

```{r, fig.cap="Mean reaction times as a function of Congruency and Posture conditions, with standard errors of the mean.",fig.width=3, fig.height=3}
library(ggplot2)
ggplot(table_means, aes(x=Posture, y=mean_RT, group=Congruency, fill=Congruency))+
  geom_bar(stat="identity", position="dodge")+
  geom_errorbar(aes(ymin=mean_RT-SEM, ymax=mean_RT+SEM), 
                position=position_dodge(width=0.9),
                width=.2)+
  theme_classic()+
  coord_cartesian(ylim=c(700,1000))
```

The original authors reported the following in their analysis, "The Stroop effects in both the sitting condition, M = 118.9 ms, t(49) = 16.52, p < .01, d = 2.376, and the standing condition, M = 95.9 ms, t(49) = 14.327, p < .01, d = 2.034."

Open data from this paper was obtained, and a script was generated to attempt a reproduction of the analysis. The following results are generated by the R analysis script.

```{r}
# conduct T-tests

sitting <- t.test(all_data$incongruent_sit,
                  all_data$congruent_sit,
                  paired=TRUE)

#apa_print(sitting)$full_result

standing <- t.test(all_data$incongruent_stand,
                  all_data$congruent_stand,
                  paired=TRUE)
```

The re-analysis for the sitting Stroop effect showed a significant Stroop effect, `r apa_print(sitting)$full_result`. The re-analysis for the standing Stroop effect was significant, `r apa_print(standing)$full_result`. 

# Power analysis

The following reports a power curve analysis for one the t-tests in the design. This shows the power of the design to detect effects of different sizes.

```{r, fig.cap = "A power curve analysis for a paired sample t-test with 50 participants."}
library(pwr)
effect_sizes <- seq(.1,2,.1)
power <- sapply(effect_sizes, 
          FUN = function(x) {
            pwr.t.test(n=50,
            d=x,
            sig.level=.05,
            type="paired",
            alternative="two.sided")$power})
plot_df <- data.frame(effect_sizes,power)

ggplot(plot_df, aes(x=effect_sizes,
                    y=power))+
  geom_point()+
  geom_line()
```


\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
