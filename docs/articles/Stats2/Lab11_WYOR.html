<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 11 WYOR • psyc7709Lab</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Lab 11 WYOR">
<meta property="og:description" content="psyc7709Lab">
<meta property="og:image" content="https://crumplab.github.io/psyc7709Lab/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@MattCrump_">
<meta name="twitter:site" content="@MattCrump_">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-79429674-12"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-79429674-12');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">psyc7709Lab</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Syllabus
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/course_docs/Spring_syllabus.html">Spring 2021</a>
    </li>
    <li>
      <a href="../../articles/course_docs/Syllabus.html">Fall 2020</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">STATS 2 Spring 2021</li>
    <li>
      <a href="../../articles/Stats2/Lab1_Shape.html">Lab 1 Shaping Data</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab2_Multiple_regression_I.html">Lab 2 Multiple Regression</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab3_Multiple_regression_II.html">Lab 3 Multiple Regression II</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab4_ANOVA.html">Lab 4 ANOVA</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab5_ANOVA_Randomization.html">Lab 5 ANOVA and Randomization</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab6_Comparisons.html">Lab 6 Comparisons</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab7_Factorial_ANOVA.html">Lab 7 Factorial ANOVA</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab8_Contrasts.html">Lab 8 Contrast Analyses</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab9_RM_ANOVA.html">Lab 9 RM ANOVA</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab10_Nested_Designs.html">Lab 10 Nested Designs</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab11_WYOR.html">Lab 11 WYOR</a>
    </li>
    <li class="dropdown-header">STATS 1 FALL 2020</li>
    <li>
      <a href="../../articles/Stats1/Getting_Started.html">Getting Started</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab1_Basics.html">Lab 1 Basics</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab2_Descriptives.html">Lab 2 Descriptives</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab3_Distributions_I.html">Lab 3 Distributions I</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab4_Distributions_II.html">Lab 4 Distributions II</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab5_Sampling_Distributions.html">Lab 5 Sampling Distributions</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab6_Statistical_Inference.html">Lab 6 Statistical Inference</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab7_Binomial.html">Lab 7 Binomial tests</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab8_Normal.html">Lab 8 Z tests</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab9_Chisquare.html">Lab 9 Chi Square</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab10_ttest.html">Lab 10 t tests</a>
    </li>
    <li>
      <a href="../../articles/Stats1/SP_Power.html">Simulation and Power analysis I</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab11_Correlation.html">Lab 11 Correlation</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab12_Regression.html">Lab 12 Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/course_docs/reference_code.html">Coding Reference</a>
    </li>
    <li>
      <a href="../../articles/course_docs/resources.html">More resources</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Semester Project
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/Stats2/semester_project.html">Spring 2021</a>
    </li>
    <li>
      <a href="../../articles/Stats1/semester_project.html">Fall 2020</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../articles/course_docs/contribute.html">Extra Credit</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CrumpLab/psyc7709Lab">
    <span class="fas fa-lg fa-github"></span>
     
  </a>
</li>
<li>
  <a href="../../news/index.html">news</a>
</li>
<li>
  <a href="../../reference/index.html"></a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Lab11_WYOR_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 11 WYOR</h1>
                        <h4 class="author">Matthew J. C. Crump</h4>
            
            <h4 class="date">2/1/2021</h4>
      
      
      <div class="hidden name"><code>Lab11_WYOR.Rmd</code></div>

    </div>

    
    
<div id="reading" class="section level2">
<h2 class="hasAnchor">
<a href="#reading" class="anchor"></a>Reading</h2>
<p>Chapter 22 from <span class="citation"><a href="#ref-abdiExperimentalDesignAnalysis2009" role="doc-biblioref">Abdi et al.</a> (<a href="#ref-abdiExperimentalDesignAnalysis2009" role="doc-biblioref">2009</a>)</span>.</p>
</div>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>WYOR refers to “writing your own statistics.” A goal of this course has been to explore principles of statistical analysis to the point where you would be able to use those general principles to craft statistical analyses that are tailored to your designs of interest. In this final lab, the practical section discusses some of the general aspects of R formula for declaring ANOVA and linear regression models. This can help you analyze many designs similar to those discussed in class throughout the last two semesters. The conceptual section is a final example of a simulated statistical analysis, and a few parting thoughts.</p>
</div>
<div id="practical-i-r-formula" class="section level2">
<h2 class="hasAnchor">
<a href="#practical-i-r-formula" class="anchor"></a>Practical I: R formula</h2>
<p>Throughout this course we have used the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> and <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> functions to conduct linear regressions and ANOVAs. For specific designs, we also demonstrated how to use the formula syntax to declare a design of interest. However, I did not present a more general description of the formula syntax, and how it can be used to declare many different kinds of designs. This practical section provides a quick look into the formula syntax. Also, check out this blog piece on writing formulas in R as an alternate resource, <a href="https://conjugateprior.org/2013/01/formulae-in-r-anova/" class="uri">https://conjugateprior.org/2013/01/formulae-in-r-anova/</a>.</p>
<div id="read-the-formula-help-file" class="section level3">
<h3 class="hasAnchor">
<a href="#read-the-formula-help-file" class="anchor"></a>Read the formula() help file</h3>
<p>It turns out that there is a help file for the formula syntax that is actually pretty helpful. So, make sure you read it.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">?<span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>()</pre></body></html></div>
</div>
<div id="formula-basics" class="section level3">
<h3 class="hasAnchor">
<a href="#formula-basics" class="anchor"></a>Formula basics</h3>
<p>We normally see a formula inside aov or lm, as follows. The column name of the dependent variable of interest (DV) is located on the left, followed by a tilda (~), followed by the independent variable(s) of interest, and a pointer to your data frame.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(<span class="no">DV</span> ~ <span class="no">IV</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">your_data</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">DV</span> ~ <span class="no">IV</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">your_data</span>)</pre></body></html></div>
<p>Formulas can also be declared outside of these functions. For example, we can assign a formula to a named object.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">my_formula</span> <span class="kw">&lt;-</span> <span class="no">DV</span>~<span class="no">IV</span></pre></body></html></div>
<p>And, we can see that the class of this object is “formula.”</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="no">my_formula</span>)
<span class="co">#&gt; [1] "formula"</span></pre></body></html></div>
<p>Entering the name of the object alone will print out the formula to the console</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">my_formula</span>
<span class="co">#&gt; DV ~ IV</span></pre></body></html></div>
<p>There are also helper functions for formula objects that allow you inspect the individual terms in the formula.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span>(<span class="no">my_formula</span>)
<span class="co">#&gt; DV ~ IV</span>
<span class="co">#&gt; attr(,"variables")</span>
<span class="co">#&gt; list(DV, IV)</span>
<span class="co">#&gt; attr(,"factors")</span>
<span class="co">#&gt;    IV</span>
<span class="co">#&gt; DV  0</span>
<span class="co">#&gt; IV  1</span>
<span class="co">#&gt; attr(,"term.labels")</span>
<span class="co">#&gt; [1] "IV"</span>
<span class="co">#&gt; attr(,"order")</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; attr(,"intercept")</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; attr(,"response")</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; attr(,".Environment")</span>
<span class="co">#&gt; &lt;environment: R_GlobalEnv&gt;</span></pre></body></html></div>
<p>If you have assigned a formula to an object, you can then use the object in place of the formula in <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> or <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tibble</span>)
<span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="kw">DV</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">20</span>,<span class="fl">0</span>,<span class="fl">1</span>),
                    <span class="kw">IV</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>,<span class="st">"B"</span>), <span class="kw">each</span><span class="kw">=</span><span class="fl">10</span>))

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(<span class="no">DV</span> ~ <span class="no">IV</span>, <span class="no">some_data</span>))
<span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="co">#&gt; IV           1  2.415  2.4148   3.236 0.0888 .</span>
<span class="co">#&gt; Residuals   18 13.431  0.7462                 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># is the same as</span>

<span class="no">my_formula</span> <span class="kw">&lt;-</span> <span class="no">DV</span> ~ <span class="no">IV</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(<span class="no">my_formula</span>, <span class="no">some_data</span>))
<span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="co">#&gt; IV           1  2.415  2.4148   3.236 0.0888 .</span>
<span class="co">#&gt; Residuals   18 13.431  0.7462                 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></body></html></div>
</div>
<div id="formula-operators" class="section level3">
<h3 class="hasAnchor">
<a href="#formula-operators" class="anchor"></a>Formula operators</h3>
<p>There are several formula operators to be aware of, including <code>~</code>, <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>, <code>:</code>, <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code>, <code><a href="https://rdrr.io/r/base/Arithmetic.html">^</a></code>, <code><a href="https://rdrr.io/r/base/match.html">%in%</a></code>, <code><a href="https://rdrr.io/r/base/Arithmetic.html">/</a></code>, and <code><a href="https://rdrr.io/r/base/Arithmetic.html">-</a></code>.</p>
<p>The tilda <code>~</code> operator is used to separately declare the dependent variable from the “model,” or set of independent variables used to account for variation in the dependent variable.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">
<span class="co"># examples of DV ~ model</span>

<span class="co"># one factor</span>
<span class="no">DV</span> ~ <span class="no">A</span>

<span class="co"># two factors no interaction</span>
<span class="no">DV</span> ~ <span class="no">A</span>+<span class="no">B</span>

<span class="co"># three factors, all possible interactions</span>
<span class="no">DV</span> ~ <span class="no">A</span>*<span class="no">B</span>*<span class="no">C</span></pre></body></html></div>
<p>The plus <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> operator is used to “add” specific terms to the model. For example, if you had one, two, or three independent variables, you could have different models that contain one, two, or three of those variables.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">DV</span> ~ <span class="no">A</span>
<span class="no">DV</span> ~ <span class="no">A</span>+<span class="no">B</span>
<span class="no">DV</span> ~ <span class="no">A</span>+<span class="no">B</span>+<span class="no">C</span></pre></body></html></div>
<p>Importantly, the <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> sign adds individual terms only and nothing more. For example, a factorial design with three independent variables (A, B, C), has several two-way interactions and a three-way interaction. However, using the plus operator, these interaction terms will not be added unless they are explicitly declared.</p>
<p>For example, we can inspect the terms for the formula <code>DV ~ A+B+C</code>, and see that there are only three terms, one for each independent variable.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span>(<span class="no">DV</span> ~ <span class="no">A</span>+<span class="no">B</span>+<span class="no">C</span>))$<span class="no">factors</span>
<span class="co">#&gt;    A B C</span>
<span class="co">#&gt; DV 0 0 0</span>
<span class="co">#&gt; A  1 0 0</span>
<span class="co">#&gt; B  0 1 0</span>
<span class="co">#&gt; C  0 0 1</span></pre></body></html></div>
<p>Interaction terms can be declared using <code>:</code>. For example, <code>A:B</code> would specify an interaction between and A and B. Using the <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> operator, we can add in individual interaction terms declared using the <code>:</code> operator.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co">## add the two-interaction between A and B</span>
<span class="no">DV</span> ~ <span class="no">A</span> + <span class="no">B</span> + <span class="no">C</span> + <span class="no">A</span>:<span class="no">B</span>
<span class="co">#&gt; DV ~ A + B + C + A:B</span>

<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span>(<span class="no">DV</span> ~ <span class="no">A</span> + <span class="no">B</span> + <span class="no">C</span> + <span class="no">A</span>:<span class="no">B</span>))$<span class="no">factors</span>
<span class="co">#&gt;    A B C A:B</span>
<span class="co">#&gt; DV 0 0 0   0</span>
<span class="co">#&gt; A  1 0 0   1</span>
<span class="co">#&gt; B  0 1 0   1</span>
<span class="co">#&gt; C  0 0 1   0</span>

<span class="co">## add all two-way interactions</span>

<span class="no">DV</span> ~ <span class="no">A</span> + <span class="no">B</span> + <span class="no">C</span> + <span class="no">A</span>:<span class="no">B</span> + <span class="no">A</span>:<span class="no">C</span> + <span class="no">B</span>:<span class="no">C</span>
<span class="co">#&gt; DV ~ A + B + C + A:B + A:C + B:C</span>

<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span>(<span class="no">DV</span> ~ <span class="no">A</span> + <span class="no">B</span> + <span class="no">C</span> + <span class="no">A</span>:<span class="no">B</span> + <span class="no">A</span>:<span class="no">C</span> + <span class="no">B</span>:<span class="no">C</span>))$<span class="no">factors</span>
<span class="co">#&gt;    A B C A:B A:C B:C</span>
<span class="co">#&gt; DV 0 0 0   0   0   0</span>
<span class="co">#&gt; A  1 0 0   1   1   0</span>
<span class="co">#&gt; B  0 1 0   1   0   1</span>
<span class="co">#&gt; C  0 0 1   0   1   1</span>

<span class="co">## add all interactions</span>

<span class="no">DV</span> ~ <span class="no">A</span> + <span class="no">B</span> + <span class="no">C</span> + <span class="no">A</span>:<span class="no">B</span> + <span class="no">A</span>:<span class="no">C</span> + <span class="no">B</span>:<span class="no">C</span> + <span class="no">A</span>:<span class="no">B</span>:<span class="no">C</span>
<span class="co">#&gt; DV ~ A + B + C + A:B + A:C + B:C + A:B:C</span>

<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span>(<span class="no">DV</span> ~ <span class="no">A</span> + <span class="no">B</span> + <span class="no">C</span> + <span class="no">A</span>:<span class="no">B</span> + <span class="no">A</span>:<span class="no">C</span> + <span class="no">B</span>:<span class="no">C</span> + <span class="no">A</span>:<span class="no">B</span>:<span class="no">C</span>))$<span class="no">factors</span>
<span class="co">#&gt;    A B C A:B A:C B:C A:B:C</span>
<span class="co">#&gt; DV 0 0 0   0   0   0     0</span>
<span class="co">#&gt; A  1 0 0   1   1   0     1</span>
<span class="co">#&gt; B  0 1 0   1   0   1     1</span>
<span class="co">#&gt; C  0 0 1   0   1   1     1</span></pre></body></html></div>
<p>The <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> operator signifies the crossing of factors. For example, in a 2x2 design, the two levels of A are fully crossed with the two levels of B. This design has two main effects (A and B), and one interaction term (A:B). The <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> operator is a shortcut to include all of the terms (main effects and interactions) in a crossed design, without having to specify each of them individually.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">DV</span> ~ <span class="no">A</span>*<span class="no">B</span>
<span class="co">#&gt; DV ~ A * B</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span>(<span class="no">DV</span> ~ <span class="no">A</span>*<span class="no">B</span>))$<span class="no">factors</span>
<span class="co">#&gt;    A B A:B</span>
<span class="co">#&gt; DV 0 0   0</span>
<span class="co">#&gt; A  1 0   1</span>
<span class="co">#&gt; B  0 1   1</span>

<span class="co"># is the same as</span>
<span class="no">DV</span> ~ <span class="no">A</span> + <span class="no">B</span> + <span class="no">A</span>:<span class="no">B</span>
<span class="co">#&gt; DV ~ A + B + A:B</span>

<span class="co"># 3-factor crossed</span>

<span class="no">DV</span> ~ <span class="no">A</span>*<span class="no">B</span>*<span class="no">C</span>
<span class="co">#&gt; DV ~ A * B * C</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span>(<span class="no">DV</span> ~ <span class="no">A</span>*<span class="no">B</span>*<span class="no">C</span>))$<span class="no">factors</span>
<span class="co">#&gt;    A B C A:B A:C B:C A:B:C</span>
<span class="co">#&gt; DV 0 0 0   0   0   0     0</span>
<span class="co">#&gt; A  1 0 0   1   1   0     1</span>
<span class="co">#&gt; B  0 1 0   1   0   1     1</span>
<span class="co">#&gt; C  0 0 1   0   1   1     1</span>

<span class="co">#is the same as </span>

<span class="no">DV</span> ~ <span class="no">A</span> + <span class="no">B</span> + <span class="no">C</span> + <span class="no">A</span>:<span class="no">B</span> + <span class="no">A</span>:<span class="no">C</span> + <span class="no">B</span>:<span class="no">C</span> + <span class="no">A</span>:<span class="no">B</span>:<span class="no">C</span>
<span class="co">#&gt; DV ~ A + B + C + A:B + A:C + B:C + A:B:C</span></pre></body></html></div>
<p>The <code><a href="https://rdrr.io/r/base/Arithmetic.html">-</a></code> operator can subtract terms from the model. For example, let’s say you had a design with three crossed factors, but you did not want to include the 3-way interaction:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co"># omit the three-way interaction</span>
<span class="no">DV</span> ~ <span class="no">A</span>*<span class="no">B</span>*<span class="no">C</span> - <span class="no">A</span>:<span class="no">B</span>:<span class="no">C</span>
<span class="co">#&gt; DV ~ A * B * C - A:B:C</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span>(<span class="no">DV</span> ~ <span class="no">A</span>*<span class="no">B</span>*<span class="no">C</span> - <span class="no">A</span>:<span class="no">B</span>:<span class="no">C</span>))$<span class="no">factors</span>
<span class="co">#&gt;    A B C A:B A:C B:C</span>
<span class="co">#&gt; DV 0 0 0   0   0   0</span>
<span class="co">#&gt; A  1 0 0   1   1   0</span>
<span class="co">#&gt; B  0 1 0   1   0   1</span>
<span class="co">#&gt; C  0 0 1   0   1   1</span>

<span class="co"># omit the two-way interactions</span>
<span class="no">DV</span> ~ <span class="no">A</span>*<span class="no">B</span>*<span class="no">C</span> - <span class="no">A</span>:<span class="no">B</span> - <span class="no">A</span>:<span class="no">C</span> - <span class="no">B</span>:<span class="no">C</span>
<span class="co">#&gt; DV ~ A * B * C - A:B - A:C - B:C</span></pre></body></html></div>
<p>The <code><a href="https://rdrr.io/r/base/match.html">%in%</a></code> operator is used to declare nesting, such as <code>A%in%B</code>, where the term on the left is nested in the term on the right. The <code><a href="https://rdrr.io/r/base/Arithmetic.html">/</a></code> operator can also be used to indicate nesting.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">DV</span> ~ <span class="no">A</span>+ <span class="no">A</span><span class="kw">%in%</span><span class="no">B</span>
<span class="co">#&gt; DV ~ A + A %in% B</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span>(<span class="no">DV</span> ~ <span class="no">A</span> + <span class="no">A</span><span class="kw">%in%</span><span class="no">B</span>))$<span class="no">factors</span>
<span class="co">#&gt;    A A:B</span>
<span class="co">#&gt; DV 0   0</span>
<span class="co">#&gt; A  1   2</span>
<span class="co">#&gt; B  0   1</span>

<span class="no">DV</span> ~ <span class="no">A</span>+ <span class="no">A</span>/<span class="no">B</span>
<span class="co">#&gt; DV ~ A + A/B</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span>(<span class="no">DV</span> ~ <span class="no">A</span> + <span class="no">A</span>/<span class="no">B</span>))$<span class="no">factors</span>
<span class="co">#&gt;    A A:B</span>
<span class="co">#&gt; DV 0   0</span>
<span class="co">#&gt; A  1   2</span>
<span class="co">#&gt; B  0   1</span></pre></body></html></div>
</div>
<div id="error" class="section level3">
<h3 class="hasAnchor">
<a href="#error" class="anchor"></a>Error()</h3>
<p>The above formulas would apply to between-subjects variables, or “fixed” effects. It is also possible to include random effects, however it is assumed that the designs are balanced. The <code><a href="https://rdrr.io/r/stats/aov.html">Error()</a></code> term is used to “specify error strata” (according the help file from aov). We have used <code><a href="https://rdrr.io/r/stats/aov.html">Error()</a></code> in class for designs with repeated measures. Here are some examples:</p>
<div id="one-random-factor" class="section level4">
<h4 class="hasAnchor">
<a href="#one-random-factor" class="anchor"></a>One Random factor</h4>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">DV</span> ~ <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">Error</a></span>(<span class="no">A</span>)
<span class="co">#&gt; DV ~ Error(A)</span></pre></body></html></div>
</div>
<div id="one-factor-with-repeated-measures" class="section level4">
<h4 class="hasAnchor">
<a href="#one-factor-with-repeated-measures" class="anchor"></a>One Factor, with repeated Measures</h4>
<p>Note, <code>subject</code> refers to the column name coding the subject variable in your data frame.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">DV</span> ~ <span class="no">A</span> + <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">Error</a></span>(<span class="no">subject</span>)
<span class="co">#&gt; DV ~ A + Error(subject)</span></pre></body></html></div>
</div>
<div id="two-factor-both-repeated-measures" class="section level4">
<h4 class="hasAnchor">
<a href="#two-factor-both-repeated-measures" class="anchor"></a>Two factor, both repeated measures</h4>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">DV</span> ~ <span class="no">A</span>*<span class="no">B</span> + <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">Error</a></span>(<span class="no">subject</span>/(<span class="no">A</span>*<span class="no">B</span>))
<span class="co">#&gt; DV ~ A * B + Error(subject/(A * B))</span></pre></body></html></div>
</div>
<div id="two-factor-a-between-fixed-b-repeated-measures" class="section level4">
<h4 class="hasAnchor">
<a href="#two-factor-a-between-fixed-b-repeated-measures" class="anchor"></a>Two factor, A between fixed, B repeated measures</h4>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">DV</span> ~ <span class="no">A</span>*<span class="no">B</span> + <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">Error</a></span>(<span class="no">subject</span>/<span class="no">B</span>)
<span class="co">#&gt; DV ~ A * B + Error(subject/B)</span></pre></body></html></div>
</div>
</div>
<div id="conclusionwhen-in-doubt-reproduce-a-textbook-example" class="section level3">
<h3 class="hasAnchor">
<a href="#conclusionwhen-in-doubt-reproduce-a-textbook-example" class="anchor"></a>Conclusion…when in doubt, reproduce a textbook example</h3>
<p>Specifying formula in base R for a design of interest can be challenging, especially as the designs become more complicated. If you have unbalanced designs with multiple IVs, that are combinations of fixed and random and nested and repeated measures, then you will have more work to do. For example, you may have to learn about different R packages for mixed models such as <code>lme4</code> or <code>nlme</code>, along with the slightly different formula syntax that they use. To the extent possible, when using unfamiliar statistics software or packages, it can be very helpful to find a textbook example that you can trust (e.g., a fully worked out example analysis for a design of interest), and then attempt to reproduce that example using software as a way to confirm expected behavior.</p>
</div>
</div>
<div id="conceptual-i-simulating-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#conceptual-i-simulating-statistics" class="anchor"></a>Conceptual I: Simulating statistics</h2>
<p>Throughout the course we conducted several statistical simulations, including simulations for power analysis. The simulations had several purposes. First, they give you some experience with general coding in R (e.g., to run loops and stored data from the simulations). Second, they concretely illustrate concepts like random sampling and sampling distributions and show how simulated results should converge on analytic procedures over the long run. Last, they are very flexible and can be used to anticipate possible outcomes of experimental designs, as well as develop inferential models to interpret possible outcomes.</p>
<div id="basic-recipe-for-simulating-designs-in-r" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-recipe-for-simulating-designs-in-r" class="anchor"></a>Basic recipe for simulating designs in R</h3>
<ol style="list-style-type: decimal">
<li>Declare a data frame that represents the structure of your design, down to the smallest detail you are interested in. For example, your data frame could include columns for the dependent variable and independent variables in the design. Each row could be an individual subject mean.</li>
<li>Make explicit assumptions about the distributions underlying your measurements. Populate the DV with values sampled from those distributions.</li>
<li>A null model assumes that the distribution of your DV does not change across the conditions/levels of the IV. Alternate models assume that the distributions between conditions/levels are different somehow. You get to choose what kind of simulation you are running, so you choose to specify the form of any differences in the distributions.</li>
<li>After you have populated the data frame with possible data, then you can analyse the simulated data to answer a question of interest. This could involve applying a standard inferential test, to generate a test-statistic (e..g, t, F, r, etc), or some other statistic of interest (e.g., a mean difference).</li>
<li>Repeat the process of randomly generating simulated data, and analyzing it to arrive at test-statistics of interest. Repeat roughly 10,000 times, save the test-statistics every time to produce a simulated sampling distribution for the each test-statistic.</li>
<li>Use the simulated sampling distribution for inference or power analysis for design planning.</li>
</ol>
</div>
<div id="a-conundrum-concrete-vs--abstract-test-statistics" class="section level3">
<h3 class="hasAnchor">
<a href="#a-conundrum-concrete-vs--abstract-test-statistics" class="anchor"></a>A conundrum: Concrete vs. abstract test-statistics</h3>
<p>Many test-statistics, like z, t, F, and r, are somewhat abstract and opaque. For example, is an F-value of 3, large or small? Does it mean that you should care about a difference between two means? It depends on factors like the degrees of freedom etc. Alternatively, sometimes test-statistics could be more concrete. For example, if I told you one population had a mean height of 5 ft, and another had a mean height of 6ft, then we could have a mean difference of 1ft. Because we are familiar with feet to measure height, a 1 ft difference is fairly concrete and, relative to an F value, fairly immediate to interpret.</p>
<p>Using simulation techniques it is possible to evaluate “concrete” statistics. For example, consider a simple 1 factor design (between-subjects). The purpose of this design is simply to determine if there is a difference between the means of group A and group B.</p>
<p>The simulation below conducts such an experiment 10,000. It is a simulation of the null hypothesis, so measures are randomly drawn from a normal distribution with mean = 0 and sd = 1. I create several simulated sampling distributions of various test-statistics to illustrate how the simulation procedure is very flexible. Then, we look at whether the null-hypotheses agree.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tibble</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="co"># declare simulation paramters</span>
<span class="no">N</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">effect_size</span> <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">null_distribution</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>()
<span class="no">iterations</span> <span class="kw">&lt;-</span> <span class="fl">10000</span>

<span class="co"># run simulation</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">iterations</span>){

  <span class="co"># create a random sample of data</span>
  <span class="no">null_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="kw">subjects</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:(<span class="no">N</span>*<span class="fl">2</span>))),
                      <span class="kw">IV</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>,<span class="st">"B"</span>), <span class="kw">each</span> <span class="kw">=</span> <span class="no">N</span>)),
                      <span class="kw">DV</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">N</span>,<span class="fl">0</span>,<span class="fl">1</span>),<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">N</span>,<span class="no">effect_size</span>,<span class="fl">1</span>))
                      )

  <span class="co"># run statistical analyses</span>
  <span class="no">aov_summary</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(<span class="no">DV</span>~<span class="no">IV</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">null_data</span>))

  <span class="no">SS_IV</span> <span class="kw">&lt;-</span> <span class="no">aov_summary</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">`Sum Sq`</span>[<span class="fl">1</span>]
  <span class="no">SS_residuals</span> <span class="kw">&lt;-</span> <span class="no">aov_summary</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">`Sum Sq`</span>[<span class="fl">2</span>]
  <span class="no">SS_total</span> <span class="kw">&lt;-</span> <span class="no">SS_IV</span>+<span class="no">SS_residuals</span>
  <span class="no">MS_IV</span> <span class="kw">&lt;-</span> <span class="no">aov_summary</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">`Mean Sq`</span>[<span class="fl">1</span>]
  <span class="no">MS_residuals</span> <span class="kw">&lt;-</span> <span class="no">aov_summary</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">`Mean Sq`</span>[<span class="fl">2</span>]
  <span class="no">F_val</span> <span class="kw">&lt;-</span> <span class="no">aov_summary</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">`F value`</span>[<span class="fl">1</span>]
  <span class="no">means</span> <span class="kw">&lt;-</span> <span class="no">null_data</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">IV</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="kw">meanDV</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">DV</span>),
              <span class="kw">sdDV</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">DV</span>))
  <span class="no">mean_difference</span> <span class="kw">&lt;-</span> <span class="no">means</span>[<span class="no">means</span>$<span class="no">IV</span> <span class="kw">==</span> <span class="st">"B"</span>,]$<span class="no">meanDV</span> - <span class="no">means</span>[<span class="no">means</span>$<span class="no">IV</span> <span class="kw">==</span> <span class="st">"A"</span>,]$<span class="no">meanDV</span>
  <span class="no">abs_mean_diff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">mean_difference</span>)
  <span class="no">cohens_D</span> <span class="kw">&lt;-</span> <span class="no">mean_difference</span> / <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>((<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">means</span>$<span class="no">sdDV</span>)/<span class="fl">2</span>))
  <span class="no">t</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="no">DV</span>~<span class="no">IV</span>, <span class="kw">var.equal</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="no">null_data</span>)$<span class="no">statistic</span>
  <span class="no">abs_t</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">t</span>)

  <span class="co"># save all test-statistics</span>
  <span class="no">sim_vals</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="no">SS_IV</span>,
                    <span class="no">SS_residuals</span>,
                    <span class="no">SS_total</span>,
                    <span class="no">MS_IV</span>,
                    <span class="no">MS_residuals</span>,
                    <span class="no">F_val</span>,
                    <span class="no">mean_difference</span>,
                    <span class="no">abs_mean_diff</span>,
                    <span class="no">cohens_D</span>,
                    <span class="no">t</span>,
                    <span class="no">abs_t</span>
                    )

  <span class="co"># append saved test-statsistics to the null-distribution tibble</span>
  <span class="no">null_distribution</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="no">null_distribution</span>,
                             <span class="no">sim_vals</span>)
}</pre></body></html></div>
<p>We have now created seperate null-distributions for each of the statistics that we saved. Each null-distribution has 10,000 values.</p>
<p>Consider the simulated F-distribution that we created. Let’s get the critical value from the simulated distribution, and compare it to the known critical value of F.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="co"># write a general function to get critical values from</span>
<span class="co"># a simulated distribution (vector of values)</span>

<span class="no">get_critical_value</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>,<span class="no">alpha</span>){
  <span class="no">x_sorted</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">x</span>))
  <span class="no">ind</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>)*(<span class="fl">1</span>-<span class="no">alpha</span>))
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">x_sorted</span>[<span class="no">ind</span>])
}

<span class="co"># simulated F critical value</span>
<span class="fu">get_critical_value</span>(<span class="no">null_distribution</span>$<span class="no">F_val</span>,
                   <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.05</span>)
<span class="co">#&gt; [1] 4.395502</span>

<span class="co"># analytical F critical value</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">qf</a></span>(<span class="fl">.95</span>,<span class="fl">1</span>,<span class="fl">18</span>)
<span class="co">#&gt; [1] 4.413873</span>

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">null_distribution</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">F_val</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw">bins</span><span class="kw">=</span><span class="fl">100</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="kw">xintercept</span><span class="kw">=</span><span class="fu">get_critical_value</span>(<span class="no">null_distribution</span>$<span class="no">F_val</span>,
                   <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.05</span>))</pre></body></html></div>
<p><img src="Lab11_WYOR_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>Now let’s look instead at the sampling distribution of the mean difference between group A and B.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">null_distribution</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">mean_difference</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw">bins</span><span class="kw">=</span><span class="fl">100</span>)</pre></body></html></div>
<p><img src="Lab11_WYOR_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>Let’s convert this distribution to the absolute value of the mean difference, and then find the critical value (assuming alpha =.05) associated with this distribution.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu">get_critical_value</span>(<span class="no">null_distribution</span>$<span class="no">abs_mean_diff</span>,
                   <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.05</span>)
<span class="co">#&gt; [1] 0.8791914</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">null_distribution</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">abs_mean_diff</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw">bins</span><span class="kw">=</span><span class="fl">100</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="kw">xintercept</span><span class="kw">=</span><span class="fu">get_critical_value</span>(<span class="no">null_distribution</span>$<span class="no">abs_mean_diff</span>,
                   <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.05</span>))</pre></body></html></div>
<p><img src="Lab11_WYOR_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
<div id="which-null-is-the-true-null" class="section level3">
<h3 class="hasAnchor">
<a href="#which-null-is-the-true-null" class="anchor"></a>Which null is the true null?</h3>
<p>We have created several true null distributions. Above we looked at the values of F that can be produced by chance for this design. As well, we looked at the absolute mean differences that can be produced by chance for this design. We found the critical values for both test-statistics. We could use either of them for the purposes of “null-hypothesis testing.”</p>
<p>However, the conundrum that I alluded to earlier is that the different Null distributions don’t necessarilly agree. In this particular case, they agree fairly closely, but not perfectly.</p>
<p>For example, we could use the correlation coefficienty to quickly look check whether the F values are related to the absolute mean differences across the simulations.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">null_distribution</span>),<span class="kw">digits</span><span class="kw">=</span><span class="fl">2</span>))</pre></body></html></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="5%">
<col width="10%">
<col width="7%">
<col width="5%">
<col width="10%">
<col width="5%">
<col width="13%">
<col width="11%">
<col width="7%">
<col width="5%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">SS_IV</th>
<th align="right">SS_residuals</th>
<th align="right">SS_total</th>
<th align="right">MS_IV</th>
<th align="right">MS_residuals</th>
<th align="right">F_val</th>
<th align="right">mean_difference</th>
<th align="right">abs_mean_diff</th>
<th align="right">cohens_D</th>
<th align="right">t</th>
<th align="right">abs_t</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SS_IV</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">0.23</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">0.92</td>
<td align="right">-0.04</td>
<td align="right">0.94</td>
<td align="right">-0.04</td>
<td align="right">0.04</td>
<td align="right">0.90</td>
</tr>
<tr class="even">
<td align="left">SS_residuals</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
<td align="right">0.97</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
<td align="right">-0.21</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">-0.20</td>
</tr>
<tr class="odd">
<td align="left">SS_total</td>
<td align="right">0.23</td>
<td align="right">0.97</td>
<td align="right">1.00</td>
<td align="right">0.23</td>
<td align="right">0.97</td>
<td align="right">0.01</td>
<td align="right">-0.01</td>
<td align="right">0.22</td>
<td align="right">-0.01</td>
<td align="right">0.01</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">MS_IV</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">0.23</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">0.92</td>
<td align="right">-0.04</td>
<td align="right">0.94</td>
<td align="right">-0.04</td>
<td align="right">0.04</td>
<td align="right">0.90</td>
</tr>
<tr class="odd">
<td align="left">MS_residuals</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
<td align="right">0.97</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
<td align="right">-0.21</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">-0.20</td>
</tr>
<tr class="even">
<td align="left">F_val</td>
<td align="right">0.92</td>
<td align="right">-0.21</td>
<td align="right">0.01</td>
<td align="right">0.92</td>
<td align="right">-0.21</td>
<td align="right">1.00</td>
<td align="right">-0.03</td>
<td align="right">0.86</td>
<td align="right">-0.03</td>
<td align="right">0.03</td>
<td align="right">0.93</td>
</tr>
<tr class="odd">
<td align="left">mean_difference</td>
<td align="right">-0.04</td>
<td align="right">0.00</td>
<td align="right">-0.01</td>
<td align="right">-0.04</td>
<td align="right">0.00</td>
<td align="right">-0.03</td>
<td align="right">1.00</td>
<td align="right">-0.03</td>
<td align="right">1.00</td>
<td align="right">-0.99</td>
<td align="right">-0.03</td>
</tr>
<tr class="even">
<td align="left">abs_mean_diff</td>
<td align="right">0.94</td>
<td align="right">0.00</td>
<td align="right">0.22</td>
<td align="right">0.94</td>
<td align="right">0.00</td>
<td align="right">0.86</td>
<td align="right">-0.03</td>
<td align="right">1.00</td>
<td align="right">-0.03</td>
<td align="right">0.03</td>
<td align="right">0.96</td>
</tr>
<tr class="odd">
<td align="left">cohens_D</td>
<td align="right">-0.04</td>
<td align="right">0.00</td>
<td align="right">-0.01</td>
<td align="right">-0.04</td>
<td align="right">0.00</td>
<td align="right">-0.03</td>
<td align="right">1.00</td>
<td align="right">-0.03</td>
<td align="right">1.00</td>
<td align="right">-1.00</td>
<td align="right">-0.03</td>
</tr>
<tr class="even">
<td align="left">t</td>
<td align="right">0.04</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
<td align="right">0.04</td>
<td align="right">0.00</td>
<td align="right">0.03</td>
<td align="right">-0.99</td>
<td align="right">0.03</td>
<td align="right">-1.00</td>
<td align="right">1.00</td>
<td align="right">0.03</td>
</tr>
<tr class="odd">
<td align="left">abs_t</td>
<td align="right">0.90</td>
<td align="right">-0.20</td>
<td align="right">0.01</td>
<td align="right">0.90</td>
<td align="right">-0.20</td>
<td align="right">0.93</td>
<td align="right">-0.03</td>
<td align="right">0.96</td>
<td align="right">-0.03</td>
<td align="right">0.03</td>
<td align="right">1.00</td>
</tr>
</tbody>
</table>
<p>The table above shows the entire correlation matrix. We can see that there is a large positive correlation between F and the absolute mean difference. In other words, when large differences in the means are produced by chance large F values are also produced.</p>
<p>However, because the two vectors are not perfectly correlated, they each have different opinions on what constitutes a type I error. This issue is more easily inspected below, which shows a scatterplot of the simulated F values and simulated absolute mean differences, along with critical values for each.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">test</span> <span class="kw">&lt;-</span> <span class="no">null_distribution</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">significant</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(
    <span class="no">abs_mean_diff</span> <span class="kw">&gt;</span> <span class="fl">.88</span> <span class="kw">&amp;</span> <span class="no">F_val</span> <span class="kw">&gt;</span> <span class="fl">4.4</span> ~ <span class="st">"both"</span>,
    <span class="no">abs_mean_diff</span> <span class="kw">&gt;</span> <span class="fl">.88</span> <span class="kw">&amp;</span> <span class="no">F_val</span> <span class="kw">&lt;</span> <span class="fl">4.4</span> ~ <span class="st">"Mean Difference"</span>,
    <span class="no">abs_mean_diff</span> <span class="kw">&lt;</span> <span class="fl">.88</span> <span class="kw">&amp;</span> <span class="no">F_val</span> <span class="kw">&gt;</span> <span class="fl">4.4</span> ~ <span class="st">"F"</span>
  ))

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">test</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">abs_mean_diff</span>,
                 <span class="kw">y</span><span class="kw">=</span><span class="no">F_val</span>,
                 <span class="kw">color</span><span class="kw">=</span><span class="no">significant</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="kw">xintercept</span><span class="kw">=</span><span class="fu">get_critical_value</span>(<span class="no">null_distribution</span>$<span class="no">abs_mean_diff</span>,
                   <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.05</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fu">get_critical_value</span>(<span class="no">null_distribution</span>$<span class="no">F_val</span>,
                   <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.05</span>))</pre></body></html></div>
<p><img src="Lab11_WYOR_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>The red points are simulations that exceed both critical values (these would be significant on both measures, and represent similar conclusions about what type I errors look like), note this group is less than 5% of the simulations</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">test</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">significant</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="kw">counts</span><span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span>(),
            <span class="kw">proportion</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span>()/<span class="fl">10000</span>)
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   significant     counts proportion</span>
<span class="co">#&gt;   &lt;chr&gt;            &lt;int&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 both               356     0.0356</span>
<span class="co">#&gt; 2 F                  144     0.0144</span>
<span class="co">#&gt; 3 Mean Difference    142     0.0142</span>
<span class="co">#&gt; 4 &lt;NA&gt;              9358     0.936</span></pre></body></html></div>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-abdiExperimentalDesignAnalysis2009" class="csl-entry">
Abdi, H., Edelman, B., Dowling, W. J., &amp; Valentin, D. (2009). <em>Experimental design and analysis for psychology</em>. <span>Oxford University Press</span>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://crumplab.github.io">Matthew Crump</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
