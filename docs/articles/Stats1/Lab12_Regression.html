<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 12 Regression • psyc7709Lab</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Lab 12 Regression">
<meta property="og:description" content="psyc7709Lab">
<meta property="og:image" content="https://crumplab.github.io/psyc7709Lab/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@MattCrump_">
<meta name="twitter:site" content="@MattCrump_">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-79429674-12"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-79429674-12');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">psyc7709Lab</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Syllabus
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/course_docs/Spring_syllabus.html">Spring 2021</a>
    </li>
    <li>
      <a href="../../articles/course_docs/Syllabus.html">Fall 2020</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">STATS 2 Spring 2021</li>
    <li>
      <a href="../../articles/Stats2/Lab1_Shape.html">Lab 1 Shaping Data</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab2_Multiple_regression_I.html">Lab 2 Multiple Regression</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab3_Multiple_regression_II.html">Lab 3 Multiple Regression II</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab4_ANOVA.html">Lab 4 ANOVA</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab5_ANOVA_Randomization.html">Lab 5 ANOVA and Randomization</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab6_Comparisons.html">Lab 6 Comparisons</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab7_Factorial_ANOVA.html">Lab 7 Factorial ANOVA</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab8_Contrasts.html">Lab 8 Contrast Analyses</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab9_RM_ANOVA.html">Lab 9 RM ANOVA</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab10_Nested_Designs.html">Lab 10 Nested Designs</a>
    </li>
    <li>
      <a href="../../articles/Stats2/Lab11_WYOR.html">Lab 11 WYOR</a>
    </li>
    <li class="dropdown-header">STATS 1 FALL 2020</li>
    <li>
      <a href="../../articles/Stats1/Getting_Started.html">Getting Started</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab1_Basics.html">Lab 1 Basics</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab2_Descriptives.html">Lab 2 Descriptives</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab3_Distributions_I.html">Lab 3 Distributions I</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab4_Distributions_II.html">Lab 4 Distributions II</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab5_Sampling_Distributions.html">Lab 5 Sampling Distributions</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab6_Statistical_Inference.html">Lab 6 Statistical Inference</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab7_Binomial.html">Lab 7 Binomial tests</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab8_Normal.html">Lab 8 Z tests</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab9_Chisquare.html">Lab 9 Chi Square</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab10_ttest.html">Lab 10 t tests</a>
    </li>
    <li>
      <a href="../../articles/Stats1/SP_Power.html">Simulation and Power analysis I</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab11_Correlation.html">Lab 11 Correlation</a>
    </li>
    <li>
      <a href="../../articles/Stats1/Lab12_Regression.html">Lab 12 Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/course_docs/reference_code.html">Coding Reference</a>
    </li>
    <li>
      <a href="../../articles/course_docs/resources.html">More resources</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Semester Project
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/Stats2/semester_project.html">Spring 2021</a>
    </li>
    <li>
      <a href="../../articles/Stats1/semester_project.html">Fall 2020</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../articles/course_docs/contribute.html">Extra Credit</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CrumpLab/psyc7709Lab">
    <span class="fas fa-lg fa-github"></span>
     
  </a>
</li>
<li>
  <a href="../../news/index.html">news</a>
</li>
<li>
  <a href="../../reference/index.html"></a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Lab12_Regression_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 12 Regression</h1>
                        <h4 class="author">Matthew J. C. Crump</h4>
            
            <h4 class="date">12/7/2020</h4>
      
      
      <div class="hidden name"><code>Lab12_Regression.Rmd</code></div>

    </div>

    
    
<div id="readings" class="section level2">
<h2 class="hasAnchor">
<a href="#readings" class="anchor"></a>Readings</h2>
<p><span class="citation"><a href="#ref-vokeyThinkingData7th2018" role="doc-biblioref">Vokey &amp; Allen</a> (<a href="#ref-vokeyThinkingData7th2018" role="doc-biblioref">2018</a>)</span>, Chapter 8; <span class="citation"><a href="#ref-abdiExperimentalDesignAnalysis2009" role="doc-biblioref">Abdi et al.</a> (<a href="#ref-abdiExperimentalDesignAnalysis2009" role="doc-biblioref">2009</a>)</span>, Chapters 3 and 4; <span class="citation"><a href="#ref-crumpAnsweringQuestionsData2018" role="doc-biblioref">Crump et al.</a> (<a href="#ref-crumpAnsweringQuestionsData2018" role="doc-biblioref">2018</a>)</span>, <a href="https://crumplab.github.io/statistics/Correlation.html#regression-a-mini-intro">3.5</a>.</p>
</div>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<ol style="list-style-type: decimal">
<li>Practical: Performing linear regressions with R</li>
<li>Concept I: The best fit line and least squares</li>
<li>Concept II: <span class="math inline">\(R^2\)</span> and <span class="math inline">\(F\)</span>
</li>
<li>Advanced Concept: Best fit line by brute force search</li>
</ol>
</div>
<div id="practical-i-simple-linear-regression-in-r" class="section level2">
<h2 class="hasAnchor">
<a href="#practical-i-simple-linear-regression-in-r" class="anchor"></a>Practical I: Simple linear Regression in R</h2>
<p>Some questions we’ll answer in this section:</p>
<ol style="list-style-type: decimal">
<li>How do I conduct a linear regression in R?</li>
<li>How do I find the best fit line in R?</li>
<li>How do I graph the best fit line with ggplot2?</li>
</ol>
<div id="lm" class="section level3">
<h3 class="hasAnchor">
<a href="#lm" class="anchor"></a><code>lm()</code>
</h3>
<p>Base R comes with the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function, short for <code>linear models</code>, that can perform linear regression among other analyses. We will come back to <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> in later labs.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">?<span class="no">lm</span></pre></body></html></div>
<p>Here are some basic examples of computing a linear regression with <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>. I step through the pieces after this code chunk.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># Dataframe with dependent and independent variables</span>
<span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y_dv</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X_iv</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>))

<span class="co">#compute linear regression,</span>
<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y_dv</span> ~ <span class="no">X_iv</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">some_data</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = Y_dv ~ X_iv, data = some_data)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)         X_iv  </span>
<span class="co">#&gt;         1.0          0.5</span>

<span class="co"># saving and output</span>
<span class="no">save_model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y_dv</span> ~ <span class="no">X_iv</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">some_data</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">save_model</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = Y_dv ~ X_iv, data = some_data)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;    Min     1Q Median     3Q    Max </span>
<span class="co">#&gt;  -1.50  -0.75   0.25   1.00   1.00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="co">#&gt; (Intercept)    1.000      1.126   0.888   0.4087  </span>
<span class="co">#&gt; X_iv           0.500      0.189   2.646   0.0382 *</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 1.225 on 6 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.5385, Adjusted R-squared:  0.4615 </span>
<span class="co">#&gt; F-statistic:     7 on 1 and 6 DF,  p-value: 0.03825</span>

<span class="co"># r and r^2</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span>(<span class="no">some_data</span>$<span class="no">Y_dv</span>,<span class="no">some_data</span>$<span class="no">X_iv</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pearson's product-moment correlation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  some_data$Y_dv and some_data$X_iv</span>
<span class="co">#&gt; t = 2.6458, df = 6, p-value = 0.03825</span>
<span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.06031428 0.94817953</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;       cor </span>
<span class="co">#&gt; 0.7337994</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">save_model</span>)$<span class="no">r.squared</span>
<span class="co">#&gt; [1] 0.5384615</span>
<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">save_model</span>)$<span class="no">r.squared</span>)
<span class="co">#&gt; [1] 0.7337994</span></pre></body></html></div>
<div id="use-long-data-format" class="section level4">
<h4 class="hasAnchor">
<a href="#use-long-data-format" class="anchor"></a>Use long-data format</h4>
<p><code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> requires data to be long-format (one observation per row), and in a data.frame or similar (e.g., data.table, tibble also work). By convention, I will use Y to refer to the dependent variable, and X to refer to the independent variable.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># Dataframe with dependent and independent variables</span>
<span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y_dv</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X_iv</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>))</pre></body></html></div>
</div>
<div id="specify-the-formula" class="section level4">
<h4 class="hasAnchor">
<a href="#specify-the-formula" class="anchor"></a>Specify the formula</h4>
<p>The linear regression is performed below. There two basic inputs <code><a href="https://rdrr.io/r/stats/lm.html">lm(formula = , data=)</a></code>. The formula supplied below is <code>Y_dv ~ X_iv</code>. The dependent variable is always placed on the left side (<code>Y_dv</code>), and the independent variable is placed on the right side (<code>X_dv</code>). Order matters. In this case, we are explaining/predicting variation in <code>Y_dv</code> as a function of variation in <code>X_dv</code>.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">#compute linear regression,</span>
<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y_dv</span> ~ <span class="no">X_iv</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">some_data</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = Y_dv ~ X_iv, data = some_data)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)         X_iv  </span>
<span class="co">#&gt;         1.0          0.5</span></pre></body></html></div>
<p>In class we learned that Pearson’s correlation coefficient, <span class="math inline">\(r\)</span>, is related to the coefficient of determination, <span class="math inline">\(R^2\)</span>, which measures the proportion of variance explained. <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> returns <span class="math inline">\(R^2\)</span>, but not <span class="math inline">\(r\)</span>. Below is a quick demonstration that square-rooting <span class="math inline">\(R^2\)</span> from <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, gives the same value as <span class="math inline">\(r\)</span> from <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># r and r^2</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span>(<span class="no">some_data</span>$<span class="no">Y_dv</span>,<span class="no">some_data</span>$<span class="no">X_iv</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pearson's product-moment correlation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  some_data$Y_dv and some_data$X_iv</span>
<span class="co">#&gt; t = 2.6458, df = 6, p-value = 0.03825</span>
<span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.06031428 0.94817953</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;       cor </span>
<span class="co">#&gt; 0.7337994</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span>(<span class="no">some_data</span>$<span class="no">Y_dv</span>,<span class="no">some_data</span>$<span class="no">X_iv</span>)$<span class="no">estimate</span>^<span class="fl">2</span>
<span class="co">#&gt;       cor </span>
<span class="co">#&gt; 0.5384615</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">save_model</span>)$<span class="no">r.squared</span>
<span class="co">#&gt; [1] 0.5384615</span>
<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">save_model</span>)$<span class="no">r.squared</span>)
<span class="co">#&gt; [1] 0.7337994</span></pre></body></html></div>
<p>The output prints the y-intercept and slope needed to draw the best-fit line from the regression.</p>
</div>
<div id="model-summary" class="section level4">
<h4 class="hasAnchor">
<a href="#model-summary" class="anchor"></a>Model summary</h4>
<p>In addition, if the output is assigned to an object, then it can be inspected and manipulated further. For example, additional information can be printed with the summary function.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">save_model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y_dv</span> ~ <span class="no">X_iv</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">some_data</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">save_model</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = Y_dv ~ X_iv, data = some_data)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;    Min     1Q Median     3Q    Max </span>
<span class="co">#&gt;  -1.50  -0.75   0.25   1.00   1.00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="co">#&gt; (Intercept)    1.000      1.126   0.888   0.4087  </span>
<span class="co">#&gt; X_iv           0.500      0.189   2.646   0.0382 *</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 1.225 on 6 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.5385, Adjusted R-squared:  0.4615 </span>
<span class="co">#&gt; F-statistic:     7 on 1 and 6 DF,  p-value: 0.03825</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">save_model</span>)$<span class="no">r.squared</span>
<span class="co">#&gt; [1] 0.5384615</span></pre></body></html></div>
</div>
</div>
<div id="ggplot2" class="section level3">
<h3 class="hasAnchor">
<a href="#ggplot2" class="anchor"></a>ggplot2</h3>
<p>Best fit lines can easily be displayed on scatterplots with ggplot2, here is a basic example. Note that I have only supplied the dataframe with the X and Y variables. <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> adds the dots, and <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> computes the regression and adds the line using the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> method we described above. It is possible to add confidence intervals by setting <code>se=TRUE</code>, but if it’s not clear to you how the intervals are computed, you might not decide to use this default.</p>
<div id="geom_smooth" class="section level4">
<h4 class="hasAnchor">
<a href="#geom_smooth" class="anchor"></a>geom_smooth</h4>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X_iv</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y_dv</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span><span class="kw">=</span><span class="st">'lm'</span>, <span class="kw">se</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>If you had many sets of X Y data specified in a data frame you can create multiple scatterplots, each with their own best fit line, using <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code>.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">some_data2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">4</span>*<span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">1</span>),
                         <span class="kw">X</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">4</span>*<span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">1</span>),
                        <span class="kw">set</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fl">4</span>,<span class="kw">each</span><span class="kw">=</span><span class="fl">10</span>))

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span><span class="kw">=</span><span class="st">'lm'</span>, <span class="kw">se</span><span class="kw">=</span><span class="fl">FALSE</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(~<span class="no">set</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="add-equations-and-model-info" class="section level4">
<h4 class="hasAnchor">
<a href="#add-equations-and-model-info" class="anchor"></a>Add equations and model info</h4>
<p><code>ggplot2</code> does not automatically show the regression equation or <span class="math inline">\(R^2\)</span> values, but they can be added with <a href="https://ggplot2-book.org/annotations.html">annotations</a>. Or, you could find an extension package that might do the thing you are looking for. For example, there are numerous extensions to ggplot2, <a href="https://exts.ggplot2.tidyverse.org/gallery/" class="uri">https://exts.ggplot2.tidyverse.org/gallery/</a>. One of them is <a href="https://docs.r4photobiology.info/ggpmisc/">ggpmisc</a>, which can help with adding these details to a plot.</p>
<p><code><a href="https://docs.r4photobiology.info/ggpmisc//reference/stat_poly_eq.html">ggpmisc::stat_poly_eq()</a></code> can add the <span class="math inline">\(R^2\)</span> value to the plot.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggpmisc</span>)
<span class="no">formula</span> <span class="kw">&lt;-</span> <span class="no">y</span> ~ <span class="no">x</span>
<span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc//reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span> <span class="no">X_iv</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">Y_dv</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"lm"</span>, <span class="kw">formula</span> <span class="kw">=</span> <span class="no">formula</span>) +
  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc//reference/stat_poly_eq.html">stat_poly_eq</a></span>(<span class="kw">formula</span> <span class="kw">=</span> <span class="no">formula</span>, <span class="kw">parse</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Or, you could print the regression line equation, or both. I’ll refer you to <a href="https://docs.r4photobiology.info/ggpmisc/articles/user-guide.html">examples here for more info on using ggpmisc</a>.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc//reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span> <span class="no">X_iv</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">Y_dv</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"lm"</span>, <span class="kw">formula</span> <span class="kw">=</span> <span class="no">formula</span>) +
  <span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc//reference/stat_poly_eq.html">stat_poly_eq</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span>(<span class="no">eq.label</span>)), <span class="kw">formula</span> <span class="kw">=</span> <span class="no">formula</span>,
               <span class="kw">parse</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
</div>
</div>
<div id="concept-i-the-best-fit-line-and-least-squares" class="section level2">
<h2 class="hasAnchor">
<a href="#concept-i-the-best-fit-line-and-least-squares" class="anchor"></a>Concept I: The best fit line and least squares</h2>
<p>The code chunk below generates a linear regression animation using ggplot2 and <a href="https://gganimate.com/index.html">gganimate</a>.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gganimate</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="no">d</span> <span class="kw">&lt;-</span> <span class="no">mtcars</span>
<span class="no">fit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">mpg</span> ~ <span class="no">hp</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">d</span>)
<span class="no">d</span>$<span class="no">predicted</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">fit</span>)   <span class="co"># Save the predicted values</span>
<span class="no">d</span>$<span class="no">residuals</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span>(<span class="no">fit</span>) <span class="co"># Save the residual values</span>

<span class="no">coefs</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">mpg</span> ~ <span class="no">hp</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">mtcars</span>))
<span class="no">coefs</span>[<span class="fl">1</span>]
<span class="co">#&gt; (Intercept) </span>
<span class="co">#&gt;    30.09886</span>
<span class="no">coefs</span>[<span class="fl">2</span>]
<span class="co">#&gt;          hp </span>
<span class="co">#&gt; -0.06822828</span>

<span class="no">x</span><span class="kw">&lt;-</span><span class="no">d</span>$<span class="no">hp</span>
<span class="no">move_line</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">.5</span>),<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">6</span>,-<span class="fl">6</span>,-<span class="fl">.5</span>))
<span class="no">total_error</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">move_line</span>))
<span class="no">cnt</span><span class="kw">&lt;-</span><span class="fl">0</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="no">move_line</span>){
  <span class="no">cnt</span><span class="kw">&lt;-</span><span class="no">cnt</span>+<span class="fl">1</span>
  <span class="no">predicted_y</span> <span class="kw">&lt;-</span> <span class="no">coefs</span>[<span class="fl">2</span>]*<span class="no">x</span> + <span class="no">coefs</span>[<span class="fl">1</span>]+<span class="no">i</span>
  <span class="no">error_y</span> <span class="kw">&lt;-</span> (<span class="no">predicted_y</span>-<span class="no">d</span>$<span class="no">mpg</span>)^<span class="fl">2</span>
  <span class="no">total_error</span>[<span class="no">cnt</span>]<span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">error_y</span>)/<span class="fl">32</span>)
}

<span class="no">move_line_sims</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">move_line</span>,<span class="kw">each</span><span class="kw">=</span><span class="fl">32</span>)
<span class="no">total_error_sims</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">total_error</span>,<span class="kw">each</span><span class="kw">=</span><span class="fl">32</span>)
<span class="no">sims</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fl">50</span>,<span class="kw">each</span><span class="kw">=</span><span class="fl">32</span>)

<span class="no">d</span><span class="kw">&lt;-</span><span class="no">d</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span>(), <span class="fl">50</span>))

<span class="no">d</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">d</span>,<span class="no">sims</span>,<span class="no">move_line_sims</span>,<span class="no">total_error_sims</span>)

<span class="no">anim</span><span class="kw">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">d</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">hp</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">mpg</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span>(<span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">30.09886</span>+<span class="no">move_line_sims</span>, <span class="kw">slope</span> <span class="kw">=</span> -<span class="fl">0.06822828</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">linetype</span><span class="kw">=</span><span class="st">'d'</span>), <span class="kw">color</span><span class="kw">=</span> <span class="st">'red'</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">lims</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">400</span>), <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">10</span>,<span class="fl">40</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">xend</span> <span class="kw">=</span> <span class="no">hp</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="no">predicted</span>+<span class="no">move_line_sims</span>, <span class="kw">color</span><span class="kw">=</span><span class="st">"red"</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">ymin</span><span class="kw">=</span><span class="no">predicted</span>+<span class="no">move_line_sims</span>, <span class="kw">ymax</span><span class="kw">=</span><span class="no">mpg</span>, <span class="kw">xmin</span><span class="kw">=</span><span class="no">hp</span>, <span class="kw">xmax</span><span class="kw">=</span><span class="no">hp</span>+<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">predicted</span>)+<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">residuals</span>)+<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">move_line_sims</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="no">total_error_sims</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.2</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span>(<span class="kw">low</span><span class="kw">=</span><span class="st">"lightgrey"</span>, <span class="kw">high</span><span class="kw">=</span><span class="st">"red"</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"lm"</span>, <span class="kw">se</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"blue"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span><span class="kw">=</span><span class="st">"none"</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"X"</span>)+<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Y"</span>)+
  <span class="fu"><a href="https://gganimate.com/reference/transition_manual.html">transition_manual</a></span>(<span class="kw">frames</span><span class="kw">=</span><span class="no">sims</span>)+
  <span class="fu"><a href="https://gganimate.com/reference/enter_exit.html">enter_fade</a></span>() +
  <span class="fu"><a href="https://gganimate.com/reference/enter_exit.html">exit_fade</a></span>()+
  <span class="fu"><a href="https://gganimate.com/reference/ease_aes.html">ease_aes</a></span>(<span class="st">'sine-in-out'</span>)

<span class="fu"><a href="https://gganimate.com/reference/animate.html">animate</a></span>(<span class="no">anim</span>,<span class="kw">fps</span><span class="kw">=</span><span class="fl">5</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-12-1.gif"><!-- --></p>
<p>This animation shows two key concepts we will reinforce. First, the regression line is the “best fit line.” And, the “best fit line” is the one that minimizes the sum of the squared deviations between each point and the line.</p>
<p>The blue line represents the best fit line found by linear regression. The roving black line represents other possible lines. For simplicity, the black line has the same slope, but the intercept changes so it moves up and down. As the black line moves, the little red lines show the error between the black line and each data point. The shaded rectangle for each dot represents the squared error. I shaded the the error squares…as the black line moves away from the true regression line, the error squares get bigger and bigger, and redder and redder. This indicates the fit between the line is getting worse (because the error is getting bigger), as the line moves away from the best line. As the black line moves toward the best fit line, you can see the error squares getting smaller, and I shaded them less red, to visually indicate less overall error. When the black line converges on the blue line, we have found the best fit line, the one that minimizes the sum of the squared deviations.</p>
<div id="illustrating-regression-concepts-with-r" class="section level3">
<h3 class="hasAnchor">
<a href="#illustrating-regression-concepts-with-r" class="anchor"></a>Illustrating regression concepts with R</h3>
<p>The <a href="https://crumplab.github.io/statistics/Correlation.html#regression-a-mini-intr">animation example</a> is modified from <span class="citation"><a href="#ref-crumpAnsweringQuestionsData2018" role="doc-biblioref">Crump et al.</a> (<a href="#ref-crumpAnsweringQuestionsData2018" role="doc-biblioref">2018</a>)</span> (I added the little rectangles to indicate the squared error).</p>
<p>In this concept section we will use R to create a graph like the above animation. Our goal is to see if we can use R to visually illustrate concepts of linear regression. For example, we can already plot data points as a scatterplot, and we can plot the regression line. It would be nice if we could visualize the error between each data point and the line, and perhaps also see that this error is smallest when we use the best fit line, and not some other line.</p>
</div>
<div id="create-a-scatterplot" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-scatterplot" class="anchor"></a>Create a scatterplot</h3>
<p>Here is the sample data we were using before:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>))

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div id="compute-regression-equation" class="section level3">
<h3 class="hasAnchor">
<a href="#compute-regression-equation" class="anchor"></a>Compute regression equation</h3>
<p>We can compute the regression line using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> to get the y-intercept and slope.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y</span>~<span class="no">X</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">some_data</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = Y ~ X, data = some_data)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)            X  </span>
<span class="co">#&gt;         1.0          0.5</span></pre></body></html></div>
<p>The regression line represents the best predictions for values of Y as a function of X.</p>
</div>
<div id="generate-predicted-values" class="section level3">
<h3 class="hasAnchor">
<a href="#generate-predicted-values" class="anchor"></a>Generate predicted values</h3>
<p>We can use the <code><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm()</a></code> function to compute each of the predictions for us. Thus, when X is the values 1 to 8, we see the following predictions for Y.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y</span>~<span class="no">X</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">some_data</span>))
<span class="co">#&gt;   1   2   3   4   5   6   7   8 </span>
<span class="co">#&gt; 2.5 3.5 3.0 2.0 4.0 4.5 5.0 5.5</span></pre></body></html></div>
<p>Let’s add the predictions into the graph. We will do this by adding a new column to the data.frame. Using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> we can run the prediction function on the existing columns for X and Y.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_pred</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y</span>~<span class="no">X</span>)))

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">Y_pred</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'red'</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div id="add-regression-line" class="section level3">
<h3 class="hasAnchor">
<a href="#add-regression-line" class="anchor"></a>Add regression line</h3>
<p>Lets’s also add the regression line in:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span><span class="kw">=</span><span class="st">'lm'</span>, <span class="kw">se</span><span class="kw">=</span><span class="fl">FALSE</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">Y_pred</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'red'</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div id="visualize-residual-error" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-residual-error" class="anchor"></a>Visualize residual error</h3>
<p>The next step is to visually depict the error between each black dot (a data point), and the blue line. This will involve drawing vertical lines between each black dot, and the red dot representing the prediction of the blue line. We can use <code><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment()</a></code> to draw lines.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_pred</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y</span>~<span class="no">X</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_error</span> <span class="kw">=</span> <span class="no">Y</span> - <span class="no">Y_pred</span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span><span class="kw">=</span><span class="st">'lm'</span>, <span class="kw">se</span><span class="kw">=</span><span class="fl">FALSE</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">Y_pred</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'red'</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">xend</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="no">Y</span>-<span class="no">Y_error</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>The blue line happens to be the best fit line, it is the one that minimizes the sum of the squared deviations. We have drawn the deviations as little lines between each black dot and the line.</p>
</div>
<div id="visualize-error-as-squares" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-error-as-squares" class="anchor"></a>Visualize error as squares</h3>
<p>Next, let’s illustrate the deviations as squares, which will better depict the actual quantity that is being summed over. We use <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect()</a></code> to draw rectangles.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_pred</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y</span>~<span class="no">X</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_error</span> <span class="kw">=</span> <span class="no">Y</span> - <span class="no">Y_pred</span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span><span class="kw">=</span><span class="st">'lm'</span>, <span class="kw">se</span><span class="kw">=</span><span class="fl">FALSE</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">Y_pred</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'red'</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">xend</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="no">Y</span>-<span class="no">Y_error</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">ymin</span><span class="kw">=</span><span class="no">Y</span>,
                <span class="kw">ymax</span><span class="kw">=</span><span class="no">Y_pred</span>,
                <span class="kw">xmin</span><span class="kw">=</span><span class="no">X</span>,
                <span class="kw">xmax</span><span class="kw">=</span><span class="no">X</span>+<span class="no">Y_error</span>),
            <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.2</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>These should look like squares, but they don’t because the X and Y axes aren’t exactly the same scale, and the figure height and width aren’t exactly square :</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span><span class="kw">=</span><span class="st">'lm'</span>, <span class="kw">se</span><span class="kw">=</span><span class="fl">FALSE</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">Y_pred</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'red'</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">xend</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="no">Y</span>-<span class="no">Y_error</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">ymin</span><span class="kw">=</span><span class="no">Y</span>,
                <span class="kw">ymax</span><span class="kw">=</span><span class="no">Y_pred</span>,
                <span class="kw">xmin</span><span class="kw">=</span><span class="no">X</span>,
                <span class="kw">xmax</span><span class="kw">=</span><span class="no">X</span>+<span class="no">Y_error</span>),
            <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.2</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>),
                  <span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>))</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-20-1.png" width="480"></p>
</div>
<div id="visualize-error-for-worse-fit-lines" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-error-for-worse-fit-lines" class="anchor"></a>Visualize error for “worse” fit lines</h3>
<p>Finally, let’s try one or two more graphs to illustrate that if we drew different lines, they would not be the best fit lines. If we drew a “worse” line, we should see that altogether, the squared error boxes get bigger and bigger. For example, the new red line below does not go through the black dots (the line was shifted up), and the squared errors are much larger than the ones for the blue best fit line.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_pred</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y</span>~<span class="no">X</span>))+<span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_error</span> <span class="kw">=</span> <span class="no">Y</span> - <span class="no">Y_pred</span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span><span class="kw">=</span><span class="st">'lm'</span>, <span class="kw">se</span><span class="kw">=</span><span class="fl">FALSE</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">Y_pred</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'red'</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">Y_pred</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'red'</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">xend</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="no">Y</span>-<span class="no">Y_error</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">ymin</span><span class="kw">=</span><span class="no">Y</span>,
                <span class="kw">ymax</span><span class="kw">=</span><span class="no">Y_pred</span>,
                <span class="kw">xmin</span><span class="kw">=</span><span class="no">X</span>,
                <span class="kw">xmax</span><span class="kw">=</span><span class="no">X</span>+<span class="no">Y_error</span>),
            <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.2</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>),
                  <span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>))</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-21-1.png" width="480"></p>
<p>Let’s see if we can make a faceted graph, showing the red line moving away from the blue in an upward direction in four steps. This should provide good visual evidence of the error squares growing in size.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r">
<span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_pred</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y</span>~<span class="no">X</span>)))

<span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="no">some_data</span>,
                   <span class="no">some_data</span>,
                   <span class="no">some_data</span>,
                   <span class="no">some_data</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">step</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fl">4</span>,<span class="kw">each</span> <span class="kw">=</span> <span class="fl">8</span>),
         <span class="kw">Y_pred</span> <span class="kw">=</span> <span class="no">Y_pred</span> + <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.5</span>,<span class="fl">1</span>,<span class="fl">1.5</span>,<span class="fl">2</span>), <span class="kw">each</span> <span class="kw">=</span> <span class="fl">8</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_error</span> <span class="kw">=</span> <span class="no">Y</span> - <span class="no">Y_pred</span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span><span class="kw">=</span><span class="st">'lm'</span>, <span class="kw">se</span><span class="kw">=</span><span class="fl">FALSE</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">Y_pred</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'red'</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">Y_pred</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'red'</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">xend</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="no">Y</span>-<span class="no">Y_error</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">ymin</span><span class="kw">=</span><span class="no">Y</span>,
                <span class="kw">ymax</span><span class="kw">=</span><span class="no">Y_pred</span>,
                <span class="kw">xmin</span><span class="kw">=</span><span class="no">X</span>,
                <span class="kw">xmax</span><span class="kw">=</span><span class="no">X</span>+<span class="no">Y_error</span>),
            <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.2</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>),
                  <span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(~<span class="no">step</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-22-1.png" width="576"></p>
<div class="sourceCode" id="cb22"><html><body><pre class="r">
<span class="no">slope</span> <span class="kw">=</span> <span class="fl">2</span>
<span class="no">b</span> <span class="kw">=</span> <span class="fl">1</span>
<span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_pred</span> <span class="kw">=</span> <span class="no">slope</span>*<span class="no">X</span>+<span class="no">b</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">error</span> <span class="kw">=</span> <span class="no">Y</span>-<span class="no">Y_pred</span>)

<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">some_data</span>$<span class="no">error</span>^<span class="fl">2</span>)
<span class="co">#&gt; [1] 648</span></pre></body></html></div>
</div>
</div>
<div id="concept-ii-r2-f-and-variance-explained" class="section level2">
<h2 class="hasAnchor">
<a href="#concept-ii-r2-f-and-variance-explained" class="anchor"></a>Concept II: <span class="math inline">\(R^2\)</span>, F, and variance explained</h2>
<p><span class="citation"><a href="#ref-wrightCorrelationCausation" role="doc-biblioref">Wright</a> (<a href="#ref-wrightCorrelationCausation" role="doc-biblioref">n.d.</a>)</span> is credited <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">on wikipedia</a> with coining the term <em>coefficient of determination</em> for <span class="math inline">\(R^2\)</span>. It was interesting to read that paper and think about the term coefficient of determination. Wright discussed how plain old correlations could obviously be caused by multiple causal variables, which is one reason why correlation does not equal causation. He sought methods to break a correlation into component causes or paths, and this seems to inspire the rather loaded inspirational term <em>coefficient of determination</em>. I say this term is inspirational because squaring an <span class="math inline">\(r\)</span>-value and using deterministic language doesn’t magically allow one to identify causal forces from a correlation. Nevertheless, the concept of <span class="math inline">\(R^2\)</span> does involve a systematic process of categorizing components of correlation into different parts, usually parts that can be explained and a leftover part that can’t be explained.</p>
<p>The word “explained” doesn’t have the common meaning that we actually understand anything, say about the causal relationship between one thing and another. It has a limited statistical meaning. Something like some variation in Y can be expressed in terms of a limited geometric relationship derived from variation in X, and we call some of that relationship “explained,” and call another part “unexplained.” Or, something like, if we have some 2-d points in a scatterplot, we can choose to say that each point is composed of three parts. The mean of Y, plus a prediction from a line that we drew through the points, plus some extra part that has nothing to do with the line.</p>
<div id="explaining-variance" class="section level3">
<h3 class="hasAnchor">
<a href="#explaining-variance" class="anchor"></a>Explaining variance</h3>
<p>Imagine you are trying to explain some complicated thing, and you want to keep track of how much of that thing you have explained. You could use a formula like this:</p>
<p><span class="math inline">\(\text{Total stuff to explain} = \text{Explained stuff} + \text{Unexplained stuff}\)</span></p>
<p>This conceptual formula partitions the <em>total stuff needing explanation</em> into two parts, explained and unexplained. If you could assign numbers to this formula, then you could keep track of quantities of explanation. <span class="math inline">\(R^2\)</span> and <span class="math inline">\(F\)</span> values are related statistics that give a ratio quantity relating the amount of explained stuff to unexplained stuff.</p>
</div>
<div id="r2-proportion-of-variance-explained" class="section level3">
<h3 class="hasAnchor">
<a href="#r2-proportion-of-variance-explained" class="anchor"></a><span class="math inline">\(R^2\)</span> proportion of variance explained</h3>
<p>Imagine you wanted to know a proportion of explained stuff, or a ratio of much you have explained in relation to the total amount of stuff that could be explained. The proportion would be 0 when you haven’t explained anything, and go to 1 as you explain everything that could be explained.</p>
<p><span class="math inline">\(1 = \frac{\text{Explained} + \text{Unexplained}}{\text{Total stuff to explain}}\)</span></p>
<p><span class="math inline">\(\text{Proportion explained} = \frac{\text{Explained}}{\text{Total}} =(1- \frac{\text{Unexplained}}{\text{Total}})\)</span></p>
<p>This is how <span class="math inline">\(R^2\)</span> is calculated. The quantities are replaced with a sum of squares (<span class="math inline">\(SS\)</span>) representing the total amount of variance to be explained. <span class="math inline">\(SS_{Total}\)</span> is split up into parts that “can be explained” (e.g., by the regression line), and parts that remain “unexplained” (residual error).</p>
<p><span class="math inline">\(R^2 = 1 - \frac{SS_{unexplained}}{SS_{Total}} = \frac{SS_{explained}}{SS_{Total}}\)</span></p>
<p>Note, that <span class="math inline">\(R^2\)</span> must go from 0 to 1, because it is set up as a ratio between a part of a whole (the explained part), and a whole (all of the things needing explaining). The explained part can go anywhere from 0 (explaining nothing) to 100% (explaining everything), so the proportion must go from 0 to 1.</p>
</div>
<div id="f-statistic-explained-over-unexplained" class="section level3">
<h3 class="hasAnchor">
<a href="#f-statistic-explained-over-unexplained" class="anchor"></a>F-statistic, explained over unexplained</h3>
<p>The F statistic is another way to use the general formula to create a ratio that gets larger as you are able to explain more than you can’t.</p>
<p><span class="math inline">\(F = \frac{Explained}{Unexplained}\)</span></p>
<p>Consider how the F ratio works. It is not bounded by 0 and 1. But, the number 1 is still important, it is a tipping point for your explanation.</p>
<ul>
<li><p>If <span class="math inline">\(explained = unexplained\)</span> then, <span class="math inline">\(F =1\)</span>.</p></li>
<li><p>If <span class="math inline">\(explained &gt; unexplained\)</span> then, <span class="math inline">\(F &gt; 1\)</span>;</p></li>
<li><p>and if <span class="math inline">\(explained &lt; unexplained\)</span> then, <span class="math inline">\(F &lt; 1\)</span>.</p></li>
</ul>
<p>F-statistics use measures of variance, which are sums of squares divided by relevant degrees of freedom.</p>
<p><span class="math inline">\(F = \frac{SS_{Explained}/df1}{SS_{Unexplained}/df2} = \frac{MS_{Explained}}{MS_{Unexplained}}\)</span></p>
</div>
<div id="transforming-r2-to-f" class="section level3">
<h3 class="hasAnchor">
<a href="#transforming-r2-to-f" class="anchor"></a>Transforming <span class="math inline">\(R^2\)</span> to <span class="math inline">\(F\)</span>
</h3>
<p><span class="citation"><a href="#ref-abdiExperimentalDesignAnalysis2009" role="doc-biblioref">Abdi et al.</a> (<a href="#ref-abdiExperimentalDesignAnalysis2009" role="doc-biblioref">2009</a>)</span> provide a formula (chapter 3) that shows Fs can be converted from <span class="math inline">\(R^2\)</span>.</p>
<p><span class="math inline">\(F = \frac{R^2}{1-R^2} \times (S-2)\)</span></p>
<p>The numerator is <span class="math inline">\(R^2\)</span>, which we have previously defined as the proportion of variance <strong>explained</strong>; and the denominator is the proportion of variance <strong>unexplained</strong>. So, this formula again presents F as a ratio of explained over unexplained variance.</p>
</div>
<div id="visualizing-the-sums-of-squares" class="section level3">
<h3 class="hasAnchor">
<a href="#visualizing-the-sums-of-squares" class="anchor"></a>Visualizing the sums of squares</h3>
<p>Let’s try to fill in the blanks so that we can see <span class="math inline">\(R^2\)</span> in this way:</p>
<p><span class="math inline">\(R^2 = (1- \frac{\text{Unexplained}}{\text{Total}}) = \frac{\text{Explained}}{\text{Total}}\)</span></p>
<p>We begin with a Y variable and X variable. We are going to use the variability in X as an “explanation” of the variability in Y.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">Y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>)
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)</pre></body></html></div>
<p>How does this data relate to the formula and to the task of explanation? What are we trying to explain? In this case, the Y variable is taking the place of the dependent measure. The Y variable has numbers that are different, it has variation. So in general language, we are trying to “explain” the variation in Y.</p>
</div>
<div id="ss-total" class="section level3">
<h3 class="hasAnchor">
<a href="#ss-total" class="anchor"></a>SS total</h3>
<p>In order to put a number into the denominator of our general formula, we need to quantify the total amount of variation in Y. There are two ways we have done that previously, using sums of squares, or the variance (which divides the sums of squares). <span class="math inline">\(SS_{total}\)</span> uses the mean of Y as a starting point, and sums up all of the squared deviations from the mean. So:</p>
<p><span class="math inline">\(SS_{total} = \sum{(Y_i - \bar{Y})^2}\)</span></p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">SS_total</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>((<span class="no">Y</span>-<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">Y</span>))^<span class="fl">2</span>)
<span class="no">SS_total</span>
<span class="co">#&gt; [1] 19.5</span></pre></body></html></div>
<p>The scatterplot below visualizes <span class="math inline">\(SS_total\)</span>; but, instead of a regression line as we saw earlier, the red line represents the mean of Y. So, the deviations between each dot and the red line represent the components that are added up to produce <span class="math inline">\(SS_total\)</span> for Y. Specifically, the sum of the area in all the error squares is taken as the total amount of stuff that needs to be explained. Slightly more formally, the squared deviations represent departures from the mean of Y. If all of the data in Y had the same number, there would be no departures from the mean, and the mean would “explain everything,” leaving nothing left for any other variable to explain.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_pred</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">Y</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_error</span> <span class="kw">=</span> <span class="no">Y</span> - <span class="no">Y_pred</span>)

(<span class="no">total_plot</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">Y_pred</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'black'</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">xend</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="no">Y</span>-<span class="no">Y_error</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">ymin</span><span class="kw">=</span><span class="no">Y</span>,
                <span class="kw">ymax</span><span class="kw">=</span><span class="no">Y_pred</span>,
                <span class="kw">xmin</span><span class="kw">=</span><span class="no">X</span>,
                <span class="kw">xmax</span><span class="kw">=</span><span class="no">X</span>+<span class="no">Y_error</span>),
            <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.2</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>),
                  <span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"SS Total"</span>)
  )</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-26-1.png" width="480"></p>
<p>Before moving on, let’s tie the word “explanation” to the idea of prediction. If we were trying to make guesses about the numbers in Y we could use the mean of Y as a best guess or prediction. According to a least squares criterion, the mean is in the center of the data, and it is the value produces the smallest sum of squared deviations. If you guessed the mean for Y every time you sampled a number for Y, you’d be off by some amount each time, and squaring and summing these little errors would give you a total that you could say represents all of variation not accounted for by the mean.</p>
<p>In linear regression we ask whether we can improve our prediction beyond using mean of Y. For example, if we had another variable like X, could we make use of that variable to improve predictions about Y? In other words, is there a way we can line up Y values and X values in such a way that <strong>reduces</strong> the sum of squared errors. If this could be achieved, then knowing something about the mean of Y <strong>and</strong> knowing something about X should reduce prediction error.</p>
</div>
<div id="ss-unexplained-residuals" class="section level3">
<h3 class="hasAnchor">
<a href="#ss-unexplained-residuals" class="anchor"></a>SS unexplained (residuals)</h3>
<p>Consider now the regression line, and the squared deviations that we produced in the first concept section. I colored the error squares red to flag the fact that the blue regression line does not explain these deviations from the blue line.</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_pred</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y</span>~<span class="no">X</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_error</span> <span class="kw">=</span> <span class="no">Y</span> - <span class="no">Y_pred</span>)

(<span class="no">res_plot</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span><span class="kw">=</span><span class="st">'lm'</span>, <span class="kw">se</span><span class="kw">=</span><span class="fl">FALSE</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">xend</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="no">Y</span>-<span class="no">Y_error</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">ymin</span><span class="kw">=</span><span class="no">Y</span>,
                <span class="kw">ymax</span><span class="kw">=</span><span class="no">Y_pred</span>,
                <span class="kw">xmin</span><span class="kw">=</span><span class="no">X</span>,
                <span class="kw">xmax</span><span class="kw">=</span><span class="no">X</span>+<span class="no">Y_error</span>),
            <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>,
            <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"red"</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>),
                  <span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"SS Unexplained (residual)"</span>)
  )</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-27-1.png" width="480"></p>
<p>These squared errors represent deviations from the data points to the best fit regression line between derived from X. The sum of these squares also represents a quantity of errors that are not explained (often termed residuals). In other words, we are looking at the “unexplained” part of our general formula.</p>
<p><span class="math inline">\(R^2 = (1- \frac{\text{Unexplained}}{\text{Total}}) = \frac{\text{Explained}}{\text{Total}}\)</span></p>
<p>More specifically, we are looking at another sum of squares, we could call <span class="math inline">\(SS_\text{residuals}\)</span>.</p>
<p><span class="math inline">\(SS_\text{residuals} = \sum{(Y_i - Y'_i)^2}\)</span></p>
<p>Where, <span class="math inline">\(Y'_i\)</span> refers to predicted Y values that we get from the regression equation. The predicted Y values are the red dots on the regression line.</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">Y_predicted</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y</span>~<span class="no">X</span>))
<span class="no">Y_predicted</span>
<span class="co">#&gt;   1   2   3   4   5   6   7   8 </span>
<span class="co">#&gt; 2.5 3.5 3.0 2.0 4.0 4.5 5.0 5.5</span>

<span class="no">SS_residuals</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>((<span class="no">Y</span>-<span class="no">Y_predicted</span>)^<span class="fl">2</span>)
<span class="no">SS_residuals</span>
<span class="co">#&gt; [1] 9</span>

<span class="fl">1</span>- ((<span class="no">SS_residuals</span>/(<span class="fl">8</span>-<span class="fl">2</span>)) / (<span class="no">SS_total</span>/(<span class="fl">7</span>)))
<span class="co">#&gt; [1] 0.4615385</span>


<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">Y</span>,<span class="no">X</span>)^<span class="fl">2</span>
<span class="co">#&gt; [1] 0.5384615</span></pre></body></html></div>
<p>We can do a quick check to show that we can compute <span class="math inline">\(R^2\)</span> from</p>
<p><span class="math inline">\(R^2 = (1- \frac{\text{Unexplained}}{\text{Total}}) = \frac{\text{Explained}}{\text{Total}}\)</span></p>
<p><span class="math inline">\(R^2 = (1- \frac{\text{SS_residual}}{\text{SS_total}})\)</span></p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="co">#quick check</span>
<span class="fl">1</span>-(<span class="fl">9</span>/<span class="fl">19.5</span>)
<span class="co">#&gt; [1] 0.5384615</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">Y</span>,<span class="no">X</span>)^<span class="fl">2</span>
<span class="co">#&gt; [1] 0.5384615</span></pre></body></html></div>
</div>
<div id="ss-explained-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#ss-explained-regression" class="anchor"></a>SS explained (regression)</h3>
<p>Let’s finally look at the idea of explained variance. Previously we found <span class="math inline">\(SS_{total}\)</span> and <span class="math inline">\(SS_{residual}\)</span>, but we haven’t directly computed <span class="math inline">\(SS_{explained}\)</span>:</p>
<p><span class="math inline">\(R^2 = (1- \frac{\text{Unexplained}}{\text{Total}}) = \frac{\text{Explained}}{\text{Total}}\)</span></p>
<p><span class="math inline">\(R^2 = (1- \frac{\text{SS}_{residuals}}{\text{SS}_{Total}}) = \frac{\text{SS}_{Explained}}{\text{SS}_{Total}}\)</span></p>
<p>We could use algebra to find <span class="math inline">\(SS_{Explained}\)</span>:</p>
<p><span class="math inline">\(SS_{Total} = \text{SS}_{Explained} + \text{SS}_{residuals}\)</span></p>
<p><span class="math inline">\(\text{SS}_{Explained} = SS_{Total} -\text{SS}_{residuals}\)</span></p>
<p><span class="math inline">\(\text{SS}_{Explained} = 19.5 - 9 = 10.5\)</span></p>
<p>I think it would be more interesting to show the sum of squares for <span class="math inline">\(\text{SS}_{Explained}\)</span> as squares on the scatterplots we have been making. The “explained” variance is associated the squared areas between the black line for the mean of Y, and blue regression line. I colored these squared areas blue.</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_pred</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y</span>~<span class="no">X</span>)),
         <span class="kw">Y_mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">Y</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_error</span> <span class="kw">=</span> <span class="no">Y</span> - <span class="no">Y_pred</span>,
         <span class="kw">Y_total</span> <span class="kw">=</span> <span class="no">Y</span>-<span class="no">Y_mean</span>)

(<span class="no">exp_plot</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">some_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">X</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">Y</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">Y_mean</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'black'</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span><span class="kw">=</span><span class="st">'lm'</span>, <span class="kw">se</span><span class="kw">=</span><span class="fl">FALSE</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">xend</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">Y_mean</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="no">Y_pred</span>), <span class="kw">color</span><span class="kw">=</span><span class="st">'black'</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">ymin</span><span class="kw">=</span><span class="no">Y_mean</span>,
                <span class="kw">ymax</span><span class="kw">=</span><span class="no">Y_pred</span>,
               <span class="kw">xmin</span><span class="kw">=</span><span class="no">X</span>,
                <span class="kw">xmax</span><span class="kw">=</span><span class="no">X</span>+(<span class="no">Y_pred</span> - <span class="no">Y_mean</span>)),
            <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>,
            <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"blue"</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>),
                  <span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>))+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>()+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"SS Explained (by Regression of X)"</span>))</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-30-1.png" width="480"></p>
<p>The sum of these squares refers to variance in Y that is “explained” by the combination of using the mean of Y as a predictor, and the regression line from X as a predictor.</p>
<p>Previously, we said that <span class="math inline">\(R^2\)</span> is the proportion of variance explained. Or:</p>
<p><span class="math inline">\(R^2 = \frac{SS_{Explained}}{SS_{Total}}\)</span></p>
<p>The sum of the blue squares is equivalent to <span class="math inline">\(SS_{explained}\)</span>. We could also write:</p>
<p><span class="math inline">\(SS_{Explained} = \sum (Y'_i - \bar{Y})^2\)</span></p>
<p>which means the sum of the squared differences between the predicted Y values based on the regression line and the mean of Y (e..g, the sum of the area of blue squares).</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">SS_explained</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>((<span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">Y</span>~<span class="no">X</span>)) - <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">Y</span>))^<span class="fl">2</span>)
<span class="no">SS_explained</span>
<span class="co">#&gt; [1] 10.5</span>

<span class="co">#from before</span>
<span class="no">SS_total</span>
<span class="co">#&gt; [1] 19.5</span>

<span class="co">#calculate R^2 as a proportion of total SS</span>
<span class="no">SS_explained</span>/<span class="no">SS_total</span>
<span class="co">#&gt; [1] 0.5384615</span>

(<span class="no">SS_explained</span>/<span class="fl">8</span>) / (<span class="no">SS_total</span>/<span class="fl">8</span>)
<span class="co">#&gt; [1] 0.5384615</span>

<span class="co"># compare to r^2</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">Y</span>,<span class="no">X</span>)^<span class="fl">2</span>
<span class="co">#&gt; [1] 0.5384615</span></pre></body></html></div>
</div>
<div id="all-together" class="section level3">
<h3 class="hasAnchor">
<a href="#all-together" class="anchor"></a>All together</h3>
<p>We have just created three different scatterplots illustrating that <span class="math inline">\(SS_{total} = SS_{explained} + SS_{unexplained}\)</span>. For ease of looking, I’d like to see them all in one place. We could accomplish this goal in multiple ways, but I’d like to do it by introducing a handy ggplot library called <a href="https://patchwork.data-imaginist.com/index.html">patchwork</a> that makes it easy to combine multiple plots together.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">patchwork</span>)

(<span class="no">total_plot</span> +<span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_spacer.html">plot_spacer</a></span>())/(<span class="no">exp_plot</span>+<span class="no">res_plot</span>)+
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">'SStotal = SSexplained + SSunexplained'</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-32-1.png" width="768"></p>
</div>
</div>
<div id="advanced-concept-best-fit-line-by-brute-force-search" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-concept-best-fit-line-by-brute-force-search" class="anchor"></a>Advanced Concept: Best fit line by brute force search</h2>
<p>What if you didn’t know the formulas to compute the slope and y-intercept for the best fit line? If you knew the definition of the best fit line, that it is the line the minimizes the sum of squared deviations between each point and the line (<span class="math inline">\(SS_{residual}\)</span>), then you could potentially find the best line through trial and error.</p>
<p>For example, you could pick any slope and y-intercept and calculate <span class="math inline">\(SS_{residual}\)</span>, then change the slope of the intercept up or down, and see if <span class="math inline">\(SS_{residual}\)</span> get’s smaller…you could keep doing this over and over until you can’t make <span class="math inline">\(SS_{residual}\)</span> any smaller. At the end you would have found the correct parameters for the best fit line.</p>
<p>Below is a quick example of forcing R to try and find correct values for the slope and intercept through trial and error. Sometimes it converges on the right answer in 1000 attempts, and sometimes it doesn’t. The basic idea is:</p>
<ol style="list-style-type: decimal">
<li>choose any starting slope and intercept (b)</li>
<li>compute <span class="math inline">\(SS_{residual}\)</span> between all points and line</li>
<li>randomly change slope and intercept up or down by a small value (.01)</li>
<li>compute <span class="math inline">\(SS_{residual}\)</span> again.</li>
<li>If <span class="math inline">\(SS_{residual}\)</span> is smaller than before, then save the new slope and intercept, and keep repeating</li>
<li>If <span class="math inline">\(SS_{residual}\)</span> is larger than before, then forget the new slope and intercept, and keep randomly changing them until they produce smaller <span class="math inline">\(SS_{residual}\)</span>.</li>
<li>Do this for a long time…the algorithm only allows changes to slope and intercept that make <span class="math inline">\(SS_{residual}\)</span> smaller, so over time, this value should converge on its minimum possible value…which is the one you get for the best fit line.</li>
</ol>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="no">step_size</span> <span class="kw">&lt;-</span> <span class="fl">.01</span>

<span class="no">slope</span> <span class="kw">=</span> <span class="fl">2</span>
<span class="no">b</span> <span class="kw">=</span> <span class="fl">1</span>
<span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_pred</span> <span class="kw">=</span> <span class="no">slope</span>*<span class="no">X</span>+<span class="no">b</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">error</span> <span class="kw">=</span> <span class="no">Y</span>-<span class="no">Y_pred</span>)

<span class="no">sum_deviations</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">some_data</span>$<span class="no">error</span>^<span class="fl">2</span>)

<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">1000</span>){

  <span class="no">new_slope</span> <span class="kw">&lt;-</span> <span class="no">slope</span> + <span class="no">step_size</span> * <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>,<span class="fl">1</span>), <span class="fl">1</span>)
  <span class="no">new_b</span> <span class="kw">&lt;-</span> <span class="no">b</span> + <span class="no">step_size</span> * <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>,<span class="fl">1</span>), <span class="fl">1</span>)

  <span class="no">some_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">Y</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>),
                        <span class="kw">X</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Y_pred</span> <span class="kw">=</span> <span class="no">new_slope</span>*<span class="no">X</span>+<span class="no">new_b</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">error</span> <span class="kw">=</span> <span class="no">Y</span>-<span class="no">Y_pred</span>)

<span class="no">new_sum_deviations</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">some_data</span>$<span class="no">error</span>^<span class="fl">2</span>)

<span class="kw">if</span>(<span class="no">new_sum_deviations</span> <span class="kw">&lt;</span> <span class="no">sum_deviations</span>) {
  <span class="no">sum_deviations</span> <span class="kw">&lt;-</span> <span class="no">new_sum_deviations</span>
  <span class="no">slope</span> <span class="kw">&lt;-</span> <span class="no">new_slope</span>
  <span class="no">b</span> <span class="kw">&lt;-</span> <span class="no">new_b</span>
}

}

<span class="no">slope</span>
<span class="co">#&gt; [1] 0.52</span>
<span class="no">b</span>
<span class="co">#&gt; [1] 0.86</span></pre></body></html></div>
</div>
<div id="lab-12-generalization-assignment" class="section level2">
<h2 class="hasAnchor">
<a href="#lab-12-generalization-assignment" class="anchor"></a>Lab 12 Generalization Assignment</h2>
<div id="instructions" class="section level3">
<h3 class="hasAnchor">
<a href="#instructions" class="anchor"></a>Instructions</h3>
<p>In general, labs will present a discussion of problems and issues with example code like above, and then students will be tasked with completing generalization assignments, showing that they can work with the concepts and tools independently.</p>
<p>Your assignment instructions are the following:</p>
<ol style="list-style-type: decimal">
<li>Work inside the R project “StatsLab1” you have been using</li>
<li>Create a new R Markdown document called “Lab12.Rmd”</li>
<li>Use Lab12.Rmd to show your work attempting to solve the following generalization problems. Commit your work regularly so that it appears on your Github repository.</li>
<li>
<strong>For each problem, make a note about how much of the problem you believe you can solve independently without help</strong>. For example, if you needed to watch the help video and are unable to solve the problem on your own without copying the answers, then your note would be 0. If you are confident you can complete the problem from scratch completely on your own, your note would be 100. It is OK to have all 0s or 100s anything in between.</li>
<li>Submit your github repository link for Lab 12 on blackboard.</li>
</ol>
</div>
<div id="problems" class="section level3">
<h3 class="hasAnchor">
<a href="#problems" class="anchor"></a>Problems</h3>
<ol style="list-style-type: decimal">
<li>Should you do a linear regression on this data? Explain.</li>
</ol>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">Y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">9</span>,<span class="fl">8</span>,<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">10</span>)
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">12</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">15</span>,<span class="fl">16</span>,<span class="fl">17</span>,<span class="fl">18</span>,<span class="fl">19</span>)

<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">X</span>,<span class="no">Y</span>)</pre></body></html></div>
<p><img src="Lab12_Regression_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-abdiExperimentalDesignAnalysis2009" class="csl-entry">
Abdi, H., Edelman, B., Dowling, W. J., &amp; Valentin, D. (2009). <em>Experimental design and analysis for psychology</em>. <span>Oxford University Press</span>.
</div>
<div id="ref-crumpAnsweringQuestionsData2018" class="csl-entry">
Crump, M. J. C., Navarro, D., &amp; Suzuki, J. (2018). <em>Answering questions with data: <span>Introductory Statistics For Psychology Students</span></em>. <a href="https://crumplab.github.io/statistics/">https://crumplab.github.io/statistics/</a>
</div>
<div id="ref-vokeyThinkingData7th2018" class="csl-entry">
Vokey, J. R., &amp; Allen, S. W. (2018). <em>Thinking with <span>Data</span> (7th <span>Edition</span> - <span>Revised</span>)</em>. <span>Psyence Publishing Society</span>. <a href="http://people.uleth.ca/%C2%A0vokey/pdf/thinking.pdf">http://people.uleth.ca/ vokey/pdf/thinking.pdf</a>
</div>
<div id="ref-wrightCorrelationCausation" class="csl-entry">
Wright, S. (n.d.). Correlation and <span>Causation</span>. <em>Journal of Agricultural Research</em>, <em>20</em>, 557–585.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://crumplab.github.io">Matthew Crump</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
